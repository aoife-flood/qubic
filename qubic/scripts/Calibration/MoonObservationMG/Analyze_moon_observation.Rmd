---
jupyter:
  jupytext:
    text_representation:
      extension: .Rmd
      format_name: rmarkdown
      format_version: '1.2'
      jupytext_version: 1.6.0rc0
  kernelspec:
    display_name: Python 3
    language: python
    name: python3
---

```{python}
# Config notebook
from IPython.display import display, HTML
display(HTML("<style>.container { width:95% !important; }</style>"))
```

## Analyze Moon data

```{python}
# #%matplotlib notebook
# %matplotlib inline
from matplotlib import rc
rc('figure',figsize=(9,4.5))
rc('font',size=12)
rc('text',usetex=False)

import matplotlib.pyplot as plt
from qubicpack.qubicfp import qubicfp
import qubic.fibtools as ft
import qubic.plotters as p
import qubic.lin_lib as ll
import qubic.demodulation_lib as dl
import satorchipy as stpy
from pysimulators import FitsArray

import numpy as np
from matplotlib.pyplot import *
import matplotlib.mlab as mlab
import scipy.ndimage.filters as f
import glob
import string
import scipy.signal as scsig
from scipy import interpolate
import datetime as dt
import pickle
from importlib import reload
```

```{python}
day = '2022-07-14'
keyword = '*MoonScan*'
data_dir = '/home/qubic/Calib-TD/'+day+'/'
dirs = np.sort(glob.glob(data_dir+keyword))
print (dirs)
```

```{python}
ifile = 0
thedir = dirs[ifile]
print(thedir)
qubic_focplane = qubicfp()
qubic_focplane.read_qubicstudio_dataset(thedir)
```

```{python}
ta1 = qubic_focplane.timeaxis(axistype = 'pps', asic = 1)
ta2 = qubic_focplane.timeaxis(axistype = 'pps', asic = 2)
```

```{python}
plt.plot(np.arange(len(ta1)),ta1-ta2, alpha = 0.4)
print("timeaxis element 0 from (asic 1 - asic 2) differ in {}~ms".format((ta1[0]-ta2[0])*1000))
print("timeaxis element -1 from (asic 1 - asic 2) differ in {}~ms".format((ta1[-1]-ta2[-1])*1000))
print(ta1[1:-1]-ta2[1:-1])
```

```{python}
qubic_focplane.tod()
```

```{python}

```
